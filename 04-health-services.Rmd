# Health Services and Policy Applications

## Patient Satisfaction survey

In this chapiter, we will reproduce the analysis used in the manuscript accessible at https://doi.org/10.1186/s12913-025-12596-x.

The fist step during analysis for a researcher is to pull data. Here, I pulled dataset in R markdown. This dataset names "DatasetNew" was saved in desktop within the file "Datasets". As the dataset is in excel ".xlsx", I used library(readxl). I also checked the dimensions of the dataset: it has 1,260 rows and 23 columns or variables.

Pull data


```{r}
library(readxl)
library(dplyr) # Must load dplyr to use select()

DatasetNew <- read_excel("/Users/corneille/Desktop/Datasets/DatasetNew.xlsx")
# Exclude the unwanted column named '...4'
DatasetNew <- DatasetNew %>%
  select(-`...3`)

#Explore number of rows and # columns
dim(DatasetNew)
#look at structure
str(DatasetNew)
```

The second step is to check data quality. Here, I evaluated the percent of missingness for each variable.

```{r}
library(DataExplorer)

# Visualization
plot_missing (DatasetNew)
```



 
 Create a new data frame containing no missing values for specified variables.
 
  
```{r}
# Load necessary packages
library(dplyr)
library(tidyr)

# 1. Define the set of variables to keep and check for completeness
varset <-

 c(

 'Province', 'visits', 'AgeCategory',
'Hospitalgrp', 'location', 'Gender', 'entrance', 'triage', 'medical doctor', 'laboratory', 'dispensing pharmacy', 'radiolohgy','rights respected?', 'waiting' , 'cashier'

 ) 

library(dplyr)

analytic.data <- DatasetNew %>%
  select(all_of(varset)) %>%      # keep only the variables in varset
  filter(complete.cases(.))       # keep only complete cases

dim(analytic.data)
```
 
 Data Harmonization before regression
 
```{r}

#Recode Yes/No to 1/0

yes_no_vars <- c(
  "entrance",
  "triage",
  "medical doctor",
  "laboratory",
  "dispensing pharmacy",
  "radiolohgy",
  "rights respected?",
  "waiting",
  "cashier"
)

analytic.data <- analytic.data %>%
  mutate(across(all_of(yes_no_vars),
                ~ case_when(
                  . == "Yes" ~ 1,
                  . == "No"  ~ 0,
                  TRUE       ~ NA_real_
                )))

analytic.data <- analytic.data %>%
  mutate(
    Province = recode(Province,
                      "Eastern"      = 1,
                      "Kigali City"  = 2,
                      "Northern"     = 3,
                      "Southern"     = 4,
                      "Western"      = 5) |> as.numeric()
  )

analytic.data <- analytic.data %>%
  mutate(
    visits = recode(visits,
                    "new"        = 1,
                    "returning" = 2) |> as.numeric()
  )

analytic.data <- analytic.data %>%
  mutate(
    AgeCategory = recode(AgeCategory,
                         "young" = 1,
                         "Adult" = 2) |> as.numeric()
  )


analytic.data <- analytic.data %>%
  mutate(
    Hospitalgrp = recode(Hospitalgrp,
                         "District"     = 1,
                         "higherRanked" = 2) |> as.numeric()
  )

analytic.data <- analytic.data %>%
  mutate(
    location = recode(location,
                      "rural" = 1,
                      "urban" = 2) |> as.numeric()
  )

analytic.data <- analytic.data %>%
  mutate(
    Gender = recode(Gender,
                    "Male"   = 1,
                    "Female" = 2) |> as.numeric()
  )


```
 
 
 
 Regression analysis 
 
 1. Variable 1: location

```{r}

###location#

#crude analysis

MOD1 <- glm(waiting ~ location, family = "binomial", data = analytic.data)
summary(MOD1)

# Odds ratios
exp(coef(MOD1))

exp(confint(MOD1))     

#Adjusted model


```

                        