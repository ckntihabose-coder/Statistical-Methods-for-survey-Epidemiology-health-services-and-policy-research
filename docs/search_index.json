[["index.html", "Statistical Methods for Survey, Epidemiology, Health Services and Policy Research 1 About this book", " Statistical Methods for Survey, Epidemiology, Health Services and Policy Research Corneille Killy Ntihabose 2025-12-06 1 About this book This book is under development. It will eventually cover: Survey methods for complex data (e.g., NHANES, DHS) Interrupted time series for policy evaluation Health services and policy applications (drones, oxygen systems, etc.) I will be using R in all demonstrations. I will try to make things easier to understand for non-statistical background. "],["introduction-to-the-book.html", "2 Introduction to the book", " 2 Introduction to the book This book presents practical statistical methods for analyzing survey data and evaluating health policies, with a focus on applications in epidemiology and health services research. The motivating examples are drawn from three main data sources: National Health and Nutrition Examination Survey (NHANES) Demographic and Health Surveys (DHS) Routine health information systems and policy evaluations from Rwanda The goal is to bridge the gap between methods textbooks and real analytic workflows. Throughout the book, we will: Work with complex survey designs (weights, strata, PSUs) Fit regression models commonly used in epidemiology Implement interrupted time series (ITS) and controlled ITS designs Apply methods to real questions in maternal and child health, non-communicable diseases, and health system performance R is used for all demonstrations. Code examples are written to be reproducible and annotated so that readers with limited statistical background can follow the logic step by step. "],["survey-methods.html", "3 Survey Methods 3.1 Demographic Health Surveys (DHS)", " 3 Survey Methods This chapter introduces statistical methods for the analysis of complex survey data. We focus on two widely used data sources in global and population health: National Health and Nutrition Examination Survey (NHANES) Demographic and Health Surveys (DHS) We start by briefly describing survey design features—stratification, clustering, and weighting—and why they matter for valid estimation and inference. We then demonstrate: How to import and prepare NHANES and DHS data in R How to specify the survey design using the survey package How to obtain design-corrected descriptive statistics and regression models The emphasis is on reproducible workflows that you can adapt to your own survey analyses. 3.1 Demographic Health Surveys (DHS) Demographic Health Surveys (DHS) is a survey that is implemented in many developing countries. DHS uses a cluster sampling methodology to obtain nationally representative data on population, health, and nutrition. Once completed, results are published and can be accessible by researchers. When access is given, a researcher can download and save data files. The next process of using data required statistical skills that will be described here. 3.1.1 Data importing The analysis utilizes data from five waves of the Rwanda Demographic and Health Surveys (DHS) spanning two decades (2000–2020). I imported the official SAS-formatted raw data files (.SAS7BDAT) for each cycle year into R using the haven package, verifying the file dimensions upon import for consistency. The first step is to explore the file. The command was used to list the files that are contained within the specified directory path. list.files(&quot;/Users/corneille/Desktop/Mike lab/DHS/1992/RWBR21SD&quot;) ## [1] &quot;RWBR21FL.frq&quot; &quot;RWBR21FL.frw&quot; &quot;RWBR21FL.MAP&quot; &quot;RWBR21FL.SAS&quot; &quot;RWBR21FL.SAS7BDAT&quot; The library(haven) loads the haven package into the current R session.The haven package is essential because it provides functions (like read_sas) necessary to import data files saved in formats used by other statistical software, such as SAS (Statistical Analysis System), SPSS, and Stata. The following lines read and load five different SAS data files (indicated by the .SAS7BDAT file extension) into the R environment, creating five separate data frames: library(haven) data2000 &lt;- read_sas(&quot;/Users/corneille/Desktop/Mike lab/DHS/2000/RWBR41SD/RWBR41FL.SAS7BDAT&quot;) data2005 &lt;- read_sas(&quot;/Users/corneille/Desktop/Mike lab/DHS/2005/RWBR53SD/RWBR53FL.SAS7BDAT&quot;) data2010 &lt;- read_sas(&quot;/Users/corneille/Desktop/Mike lab/DHS/2010/RWBR61SD/RWBR61FL.SAS7BDAT&quot;) data2015 &lt;- read_sas(&quot;/Users/corneille/Desktop/Mike lab/DHS/2015/RWBR70SD/RWBR70FL.SAS7BDAT&quot;) data2020 &lt;- read_sas(&quot;/Users/corneille/Desktop/Mike lab/DHS/2020/RWBR81SD/RWBR81FL.SAS7BDAT&quot;) Finally, The five commands were executed to inspect the dimensions (number of rows and columns) of each of the newly loaded data frames. This is a crucial initial step to verify that the data was imported correctly and to understand the size of each dataset (rows = number of observations/survey participants; columns = number of variables/questions). dim(data2000) ## [1] 27602 934 dim(data2005) ## [1] 30072 1077 dim(data2010) ## [1] 32639 1021 dim(data2015) ## [1] 30058 1078 dim(data2020) ## [1] 30820 1216 "],["epidemiology-methods.html", "4 Epidemiology Methods 4.1 Dataset exploration", " 4 Epidemiology Methods 4.1 Dataset exploration We will use the data from NHANES for demonstration, specifically demographic data. The first step, is to pull data from CDC website using nhanesA package. I will save the data into demo library(nhanesA) demo &lt;- nhanes(&quot;DEMO&quot;, translated = TRUE) It is possible to explore the data pulled. There are various ways such as exploring dimensions. This will show you how many rows do you have in your dataset, and number columns. Specifically, for “demo”, we have 9,965 rows and 144 columns. library(nhanesA) dim(demo) ## [1] 9965 144 It is also possible, to look at structure of the dataset, even far, looking the structure of each variable. Here, I mean the type of variable; numerical, factor, integer,…. This way will also show you how if some missing values are present. To look at entire structure, the analysst can use str(demo), however, because here we have 144 columns, we will present only 10 variables. str(demo[, 1:10]) ## &#39;data.frame&#39;: 9965 obs. of 10 variables: ## $ SEQN : num 1 2 3 4 5 6 7 8 9 10 ... ## $ SDDSRVYR: Factor w/ 1 level &quot;NHANES 1999-2000 Public Release&quot;: 1 1 1 1 1 1 1 1 1 1 ... ## $ RIDSTATR: Factor w/ 2 levels &quot;Interviewed Only&quot;,..: 2 2 2 2 2 2 2 2 2 2 ... ## $ RIDEXMON: Factor w/ 2 levels &quot;November 1 through April 30&quot;,..: 2 2 1 2 2 2 2 1 2 2 ... ## $ RIAGENDR: Factor w/ 2 levels &quot;Male&quot;,&quot;Female&quot;: 2 1 2 1 1 2 2 1 2 1 ... ## $ RIDAGEYR: num 2 77 10 1 49 19 59 13 11 43 ... ## $ RIDAGEMN: num 29 926 125 22 597 230 712 159 133 518 ... ## $ RIDAGEEX: num 31 926 126 23 597 230 712 160 133 518 ... ## $ RIDRETH1: Factor w/ 5 levels &quot;Mexican American&quot;,..: 4 3 3 4 3 5 4 3 4 4 ... ## $ RIDRETH2: Factor w/ 5 levels &quot;Non-Hispanic White&quot;,..: 2 1 1 2 1 4 2 1 2 2 ... You can also exploring percentage of missing values for each variable. To visualize this you must use “plot_missing”. To perform this, you need library(DataExplorer). For all variables, this operation can be done plot_missing (demo). However, for simplicity, we will present only 15 variables. library(DataExplorer) # Visualization plot_missing ( demo[, 1:15]) "],["health-services-and-policy-applications.html", "5 Health Services and Policy Applications 5.1 Patient Satisfaction survey", " 5 Health Services and Policy Applications 5.1 Patient Satisfaction survey In this chapter, we reproduce the analyses reported in the manuscript available at https://doi.org/10.1186/s12913-025-12596-x . The first step in any empirical analysis is data acquisition. For this exercise, the dataset was imported into R using an R Markdown workflow. The Excel file (.xlsx), named DatasetNew, was stored on the desktop within a folder labeled Datasets and was read using the readxl package. After importing the data, its structure was examined. The dataset contains 1,260 observations (rows) and 23 variables (columns). library(readxl) library(dplyr) # Must load dplyr to use select() DatasetNew &lt;- read_excel(&quot;/Users/corneille/Desktop/Datasets/DatasetNew.xlsx&quot;) ## New names: ## • `` -&gt; `...3` # Exclude the unwanted column named &#39;...4&#39; DatasetNew &lt;- DatasetNew %&gt;% select(-`...3`) #Explore number of rows and # columns dim(DatasetNew) ## [1] 1260 23 #look at structure str(DatasetNew) ## tibble [1,260 × 23] (S3: tbl_df/tbl/data.frame) ## $ No : num [1:1260] 1057 50 824 225 935 ... ## $ Province : chr [1:1260] &quot;Eastern&quot; &quot;Kigali City&quot; &quot;Southern&quot; &quot;Eastern&quot; ... ## $ District : chr [1:1260] &quot;Nyagatare&quot; &quot;Kicukiro&quot; &quot;Muhanga&quot; &quot;Ngoma&quot; ... ## $ Hospital : chr [1:1260] &quot;Nyagatare DH&quot; &quot;Masaka DH&quot; &quot;Kabgayi Dh&quot; &quot;Kibungo RH&quot; ... ## $ Age : num [1:1260] 36 58 46 54 80 28 33 41 22 39 ... ## $ Number of visits this year: num [1:1260] 1 2 2 3 3 1 1 1 1 1 ... ## $ visits : chr [1:1260] &quot;new&quot; &quot;returning&quot; &quot;returning&quot; &quot;returning&quot; ... ## $ AgeCategory : chr [1:1260] &quot;Adult&quot; &quot;Adult&quot; &quot;Adult&quot; &quot;Adult&quot; ... ## $ Hospitalgrp : chr [1:1260] &quot;District&quot; &quot;District&quot; &quot;higherRanked&quot; &quot;higherRanked&quot; ... ## $ location : chr [1:1260] &quot;urban&quot; &quot;urban&quot; &quot;rural&quot; &quot;rural&quot; ... ## $ Gender : chr [1:1260] &quot;Female&quot; &quot;Female&quot; &quot;Female&quot; &quot;Female&quot; ... ## $ entrance : chr [1:1260] &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ... ## $ reception : chr [1:1260] &quot;Yes&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; ... ## $ cashier : chr [1:1260] &quot;Yes&quot; &quot;Yes&quot; &quot;No&quot; &quot;Yes&quot; ... ## $ waiting : chr [1:1260] &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;No&quot; ... ## $ triage : chr [1:1260] &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;NA&quot; ... ## $ medical doctor : chr [1:1260] &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ... ## $ confidentiality : chr [1:1260] &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ... ## $ asked the consent? : chr [1:1260] &quot;No&quot; &quot;Yes&quot; &quot;No&quot; &quot;Yes&quot; ... ## $ laboratory : chr [1:1260] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; ... ## $ dispensing pharmacy : chr [1:1260] &quot;Yes&quot; &quot;Yes&quot; &quot;No&quot; &quot;Yes&quot; ... ## $ radiolohgy : chr [1:1260] &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; &quot;NA&quot; ... ## $ rights respected? : chr [1:1260] &quot;NA&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ... The second step is to check data quality. Here, I evaluated the percent of missingness for each variable. library(DataExplorer) # Visualization plot_missing (DatasetNew) Next, I created a new data frame restricted to complete cases, retaining only observations with no missing values in the specified variables. # Load necessary packages library(dplyr) library(tidyr) # 1. Define the set of variables to keep and check for completeness varset &lt;- c( &#39;Province&#39;, &#39;visits&#39;, &#39;AgeCategory&#39;, &#39;Hospitalgrp&#39;, &#39;location&#39;, &#39;Gender&#39;, &#39;entrance&#39;, &#39;triage&#39;, &#39;medical doctor&#39;, &#39;laboratory&#39;, &#39;dispensing pharmacy&#39;, &#39;radiolohgy&#39;,&#39;rights respected?&#39;, &#39;waiting&#39; , &#39;cashier&#39; ) library(dplyr) analytic.data &lt;- DatasetNew %&gt;% select(all_of(varset)) %&gt;% # keep only the variables in varset filter(complete.cases(.)) # keep only complete cases dim(analytic.data) ## [1] 1259 15 Prior to regression modeling, data harmonization was performed to ensure consistency and comparability across variables. This included recoding categorical variables, aligning variable formats, and verifying reference categories, thereby ensuring that all variables were appropriately structured for regression analysis. #Recode Yes/No to 1/0 yes_no_vars &lt;- c( &quot;entrance&quot;, &quot;triage&quot;, &quot;medical doctor&quot;, &quot;laboratory&quot;, &quot;dispensing pharmacy&quot;, &quot;radiolohgy&quot;, &quot;rights respected?&quot;, &quot;waiting&quot;, &quot;cashier&quot; ) analytic.data &lt;- analytic.data %&gt;% mutate(across(all_of(yes_no_vars), ~ case_when( . == &quot;Yes&quot; ~ 1, . == &quot;No&quot; ~ 0, TRUE ~ NA_real_ ))) analytic.data &lt;- analytic.data %&gt;% mutate( Province = recode(Province, &quot;Eastern&quot; = 1, &quot;Kigali City&quot; = 2, &quot;Northern&quot; = 3, &quot;Southern&quot; = 4, &quot;Western&quot; = 5) |&gt; as.numeric() ) analytic.data &lt;- analytic.data %&gt;% mutate( visits = recode(visits, &quot;new&quot; = 1, &quot;returning&quot; = 2) |&gt; as.numeric() ) analytic.data &lt;- analytic.data %&gt;% mutate( AgeCategory = recode(AgeCategory, &quot;young&quot; = 1, &quot;Adult&quot; = 2) |&gt; as.numeric() ) analytic.data &lt;- analytic.data %&gt;% mutate( Hospitalgrp = recode(Hospitalgrp, &quot;District&quot; = 1, &quot;higherRanked&quot; = 2) |&gt; as.numeric() ) analytic.data &lt;- analytic.data %&gt;% mutate( location = recode(location, &quot;rural&quot; = 1, &quot;urban&quot; = 2) |&gt; as.numeric() ) analytic.data &lt;- analytic.data %&gt;% mutate( Gender = recode(Gender, &quot;Male&quot; = 1, &quot;Female&quot; = 2) |&gt; as.numeric() ) Regression Analysis The primary independent variable included in the regression model was location, which was specified according to the predefined categories in the dataset. ###location# #crude analysis MOD1 &lt;- glm(waiting ~ location, family = &quot;binomial&quot;, data = analytic.data) summary(MOD1) ## ## Call: ## glm(formula = waiting ~ location, family = &quot;binomial&quot;, data = analytic.data) ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 2.2377 0.2402 9.315 &lt;2e-16 *** ## location -0.3619 0.1670 -2.168 0.0302 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 1044.6 on 1249 degrees of freedom ## Residual deviance: 1040.0 on 1248 degrees of freedom ## (9 observations deleted due to missingness) ## AIC: 1044 ## ## Number of Fisher Scoring iterations: 4 # Odds ratios exp(coef(MOD1)) ## (Intercept) location ## 9.3718691 0.6963245 exp(confint(MOD1)) ## Waiting for profiling to be done... ## 2.5 % 97.5 % ## (Intercept) 5.873786 15.0782390 ## location 0.503278 0.9693642 #Adjusted model "],["interrupted-time-series-analysis.html", "6 Interrupted Time Series Analysis", " 6 Interrupted Time Series Analysis "],["survival-analysis-with-nhanes.html", "7 Survival Analysis with NHANES", " 7 Survival Analysis with NHANES "],["child-stunting-analysis-using-dhs.html", "8 Child Stunting Analysis using DHS", " 8 Child Stunting Analysis using DHS "],["handling-missing-data.html", "9 Handling Missing Data", " 9 Handling Missing Data "],["appendix.html", "Appendix", " Appendix "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
